var ROW_BASE=1;var IsLoaded=false;var TABLE_NAME="tblIPv6Firewall";var TABLE_NAME2="tblIPv6Firewall2";var TABLE_NAME3="tblIPv6Firewall3";var NAME="name_";var SOURCE="source_";var DESTINATION="destination_";var PROTOCOL="protocol_";var SCHEDULE="schedule_";var SOURCE_ADDRESSRANGE_START="sourceiprangestart_";var SOURCE_ADDRESSRANGE_END="sourceiprangeend_";var DESTINATION_ADDRESSRANGE_START="destinationiprangestart_";var DESTINATION_ADDRESSRANGE_END="destinationiprangeend_";var PORT_RANGE_START="portrangestart_";var PORT_RANGE_END="portrangeend_";var EDIT_ICON="editicon_";var DELETE_ICON="delicon_";var a,b,c,d,e,f,g,h,i,j,k;var Name_CheckList=[];var tmp_Name;var tmp_Source;var tmp_Destination;var tmp_Protocol;var tmp_Schedule;var tmp_SourceAddressRangeStart;var tmp_SourceAddressRangeEnd;var tmp_DestinationAddressRangeStart;var tmp_DestinationAddressRangeEnd;var tmp_PortRangeStart;var tmp_PortRangeEnd;var IsLoaded=true;function GetHNAPInfomation(p,m,n,q,o,l,t,v,s,u,r){a=p;b=m;c=n;d=q;e=o;f=l;g=t;h=v;i=s;j=u;k=r}function myRowObject(q,w,l,t,s,m,o,x,p,n,v,u,r){this.one=q;this.two=w;this.three=l;this.four=t;this.five=s;this.six=m;this.seven=o;this.eight=x;this.nine=p;this.ten=n;this.eleven=v;this.twelve=u;this.thirteen=r}function AddRowToIndex(){var q=document.getElementById(TABLE_NAME);tmp_Name=document.getElementById("FWv6_Name").value;for(var t=0;t<Name_CheckList.length;t++){Name_CheckList[t]=null}var l=0;for(var m=1;m<=Total_FirewallRules;m++){Name_CheckList[l]=q.rows[m].cells[0].childNodes[0].innerText;console.log(Name_CheckList[l]+" ,length: "+Name_CheckList.length);l++}for(var s=0;s<Name_CheckList.length;s++){console.log(Name_CheckList[s]+" & "+tmp_Name);if(tmp_Name==Name_CheckList[s]){alert("Name cannot be the same.");return"Error"}}var v=document.getElementById("FWv6_SourceIPRange").value;var n=document.getElementById("FWv6_DestinationIPRange").value;var o=document.getElementById("FWv6_PortRange").value;var u=v.split(/[\s-]+/);d=u[u.length-2];e=u[u.length-1];var p=n.split(/[\s-]+/);g=p[p.length-2];h=p[p.length-1];var w=o.split(/[\s-]+/);j=w[w.length-2];k=w[w.length-1];var r=document.getElementById("select_FWv6_Schedule");a=document.getElementById("FWv6_Name").value;b=r.options[r.selectedIndex].text;c=document.getElementById("select_FWv6_SourceInterface").value;f=document.getElementById("select_FWv6_DestinationInterface").value;i=document.getElementById("select_FWv6_Protocol").value;switch(c){case"1":c="WAN";break;case"2":c="LAN";break;default:alert("Bad Request - Source Interface");break}switch(f){case"1":f="WAN";break;case"2":f="LAN";break;default:alert("Bad Request - Destination Interface");break}switch(i){case"1":i="TCP";break;case"2":i="UDP";break;case"3":i="Any";break;default:alert("Bad Request - Protocol Type");break}addRowToTable(null);Total_FirewallRules+=1;check_TotalRule(Limit_FirewallRules,Total_FirewallRules);return"Success"}function addRowToTable(y){if(IsLoaded){var q=document.getElementById(TABLE_NAME);var P=q.tBodies[0].rows.length;var l=P+ROW_BASE;if(y==null){y=P}else{l=y+ROW_BASE}var s=q.tBodies[0].insertRow(y);var O=s.insertCell(0);var K=document.createElement("label");K.setAttribute("id",NAME+l);K.setAttribute("size","10");K.innerHTML=a;O.appendChild(K);var N=s.insertCell(1);var I=document.createElement("label");I.setAttribute("id",SCHEDULE+l);I.setAttribute("size","10");if(b=="Always"){b=I18N("j","Always")}I.innerHTML=b;N.appendChild(I);var M=s.insertCell(2);var G=document.createElement("img");G.setAttribute("src","image/edit_btn.gif");G.setAttribute("width","28");G.setAttribute("height","28");G.setAttribute("id",EDIT_ICON+l);G.setAttribute("style","cursor:pointer");G.onclick=function(){editData(l)};M.appendChild(G);var L=s.insertCell(3);var E=document.createElement("img");E.setAttribute("src","image/trash.gif");E.setAttribute("width","41");E.setAttribute("height","41");E.setAttribute("id",DELETE_ICON+l);E.setAttribute("style","cursor:pointer");E.onclick=function(){deleteCurrentRow(this)};L.appendChild(E);var J=s.insertCell(4);var H=s.insertCell(5);var F=s.insertCell(6);var D=s.insertCell(7);var B=s.insertCell(8);var x=s.insertCell(9);var A=s.insertCell(10);var w=s.insertCell(11);var u=s.insertCell(12);var C=document.createElement("label");var z=document.createElement("label");var v=document.createElement("label");var t=document.createElement("label");var r=document.createElement("label");var p=document.createElement("label");var o=document.createElement("label");var n=document.createElement("label");var m=document.createElement("label");C.setAttribute("id",SOURCE+l);z.setAttribute("id",SOURCE_ADDRESSRANGE_START+l);v.setAttribute("id",SOURCE_ADDRESSRANGE_END+l);t.setAttribute("id",DESTINATION+l);r.setAttribute("id",DESTINATION_ADDRESSRANGE_START+l);p.setAttribute("id",DESTINATION_ADDRESSRANGE_END+l);o.setAttribute("id",PROTOCOL+l);n.setAttribute("id",PORT_RANGE_START+l);m.setAttribute("id",PORT_RANGE_END+l);C.innerHTML=c;z.innerHTML=d;v.innerHTML=e;t.innerHTML=f;r.innerHTML=g;p.innerHTML=h;o.innerHTML=i;n.innerHTML=j;m.innerHTML=k;C.style.display="none";z.style.display="none";v.style.display="none";t.style.display="none";r.style.display="none";p.style.display="none";o.style.display="none";n.style.display="none";m.style.display="none";J.appendChild(C);H.appendChild(z);F.appendChild(v);D.appendChild(t);B.appendChild(r);x.appendChild(p);A.appendChild(o);w.appendChild(n);u.appendChild(m);s.myRow=new myRowObject(K,I,G,E,C,z,v,t,r,p,o,n,m);a=null;b=null;c=null;d=null;e=null;f=null;g=null;h=null;i=null;j=null;k=null}}function editDataGet(m){var r=document.getElementById(TABLE_NAME);var z=r.rows[m].childNodes[0].childNodes[0].innerHTML;var t=r.rows[m].childNodes[1].childNodes[0].innerHTML;var n=r.rows[m].childNodes[4].childNodes[0].innerHTML;var o=r.rows[m].childNodes[5].childNodes[0].innerHTML;var u=r.rows[m].childNodes[6].childNodes[0].innerHTML;var p=r.rows[m].childNodes[7].childNodes[0].innerHTML;var w=r.rows[m].childNodes[8].childNodes[0].innerHTML;var s=r.rows[m].childNodes[9].childNodes[0].innerHTML;var y=r.rows[m].childNodes[10].childNodes[0].innerHTML;var x=r.rows[m].childNodes[11].childNodes[0].innerHTML;var l=r.rows[m].childNodes[12].childNodes[0].innerHTML;document.getElementById("FWv6_EditName").value=z;document.getElementById("FWv6_EditSourceIPRange").value=o+"-"+u;document.getElementById("FWv6_EditDestinationIPRange").value=w+"-"+s;document.getElementById("FWv6_EditPortRange").value=x+"-"+l;var v=document.getElementById("select_FWv6_EditSchedule");for(var q=0;q<=Total_ScheduleRules;q++){if(v.options[q].text===t){$("#select_FWv6_EditSchedule").selectbox("detach");$("#select_FWv6_EditSchedule").val(q);$("#select_FWv6_EditSchedule").selectbox({width:170});$("#select_FWv6_EditSchedule").selectbox("attach");break}}switch(n){case"Interface":$("#select_FWv6_EditSourceInterface").selectbox("detach");$("#select_FWv6_EditSourceInterface").val("0");$("#select_FWv6_EditSourceInterface").selectbox({width:170});$("#select_FWv6_EditSourceInterface").selectbox("attach");break;case"WAN":$("#select_FWv6_EditSourceInterface").selectbox("detach");$("#select_FWv6_EditSourceInterface").val("1");$("#select_FWv6_EditSourceInterface").selectbox({width:170});$("#select_FWv6_EditSourceInterface").selectbox("attach");break;case"LAN":$("#select_FWv6_EditSourceInterface").selectbox("detach");$("#select_FWv6_EditSourceInterface").val("2");$("#select_FWv6_EditSourceInterface").selectbox({width:170});$("#select_FWv6_EditSourceInterface").selectbox("attach");break;default:alert("Debugging Mode - tmp_editSource");break}switch(p){case"Interface":$("#select_FWv6_EditDestinationInterface").selectbox("detach");$("#select_FWv6_EditDestinationInterface").val("0");$("#select_FWv6_EditDestinationInterface").selectbox({width:170});$("#select_FWv6_EditDestinationInterface").selectbox("attach");break;case"WAN":$("#select_FWv6_EditDestinationInterface").selectbox("detach");$("#select_FWv6_EditDestinationInterface").val("1");$("#select_FWv6_EditDestinationInterface").selectbox({width:170});$("#select_FWv6_EditDestinationInterface").selectbox("attach");break;case"LAN":$("#select_FWv6_EditDestinationInterface").selectbox("detach");$("#select_FWv6_EditDestinationInterface").val("2");$("#select_FWv6_EditDestinationInterface").selectbox({width:170});$("#select_FWv6_EditDestinationInterface").selectbox("attach");break;default:alert("Debugging Mode - tmp_editDestination");break}switch(y){case"Protocol":$("#select_FWv6_EditProtocol").selectbox("detach");$("#select_FWv6_EditProtocol").val("0");$("#select_FWv6_EditProtocol").selectbox({width:170});$("#select_FWv6_EditProtocol").selectbox("attach");break;case"TCP":$("#select_FWv6_EditProtocol").selectbox("detach");$("#select_FWv6_EditProtocol").val("1");$("#select_FWv6_EditProtocol").selectbox({width:170});$("#select_FWv6_EditProtocol").selectbox("attach");break;case"UDP":$("#select_FWv6_EditProtocol").selectbox("detach");$("#select_FWv6_EditProtocol").val("2");$("#select_FWv6_EditProtocol").selectbox({width:170});$("#select_FWv6_EditProtocol").selectbox("attach");break;case"ANY":$("#select_FWv6_EditProtocol").selectbox("detach");$("#select_FWv6_EditProtocol").val("3");$("#select_FWv6_EditProtocol").selectbox({width:170});$("#select_FWv6_EditProtocol").selectbox("attach");break;default:alert("Debugging Mode - tmp_editProtocol");break}tmp_Name=z;tmp_Source=n;tmp_Destination=p;tmp_Protocol=y;tmp_Schedule=t;tmp_SourceAddressRangeStart=o;tmp_SourceAddressRangeEnd=u;tmp_DestinationAddressRangeStart=w;tmp_DestinationAddressRangeEnd=s;tmp_PortRangeStart=x;tmp_PortRangeEnd=l;setIteration(m)}function assignRowToIndex(A){var s=document.getElementById(TABLE_NAME);var u=document.getElementById("FWv6_EditName").value;if(u!=""){for(var v=0;v<Name_CheckList.length;v++){Name_CheckList[v]=null}var z=0;for(var w=1;w<=Total_FirewallRules;w++){if(A==w){Name_CheckList[z]=u}else{Name_CheckList[z]=s.rows[w].cells[0].childNodes[0].innerText}z++}for(var C=0;C<Name_CheckList.length;C++){if(u==Name_CheckList[C]){if(C==A-1){continue}else{alert("Name cannot be the same.");return"Error"}}}s.rows[A].childNodes[0].childNodes[0].innerHTML=document.getElementById("FWv6_EditName").value}var F=document.getElementById("FWv6_EditSourceIPRange").value;var H=document.getElementById("FWv6_EditDestinationIPRange").value;var t=document.getElementById("FWv6_EditPortRange").value;var m=F.split(/[\s-]+/);var l=m[m.length-2];var q=m[m.length-1];var E=H.split(/[\s-]+/);var G=E[E.length-2];var B=E[E.length-1];var J=t.split(/[\s-]+/);var p=J[J.length-2];var y=J[J.length-1];var I=document.getElementById("FWv6_EditName").value;var x=document.getElementById("select_FWv6_EditSchedule");var D=x.options[x.selectedIndex].text;var r=document.getElementById("select_FWv6_EditSourceInterface").value;var o=document.getElementById("select_FWv6_EditDestinationInterface").value;var n=document.getElementById("select_FWv6_EditProtocol").value;s.rows[A].childNodes[0].childNodes[0].innerHTML=I;if(D=="Always"){D=I18N("j","Always")}s.rows[A].childNodes[1].childNodes[0].innerHTML=D;s.rows[A].childNodes[5].childNodes[0].innerHTML=l;s.rows[A].childNodes[6].childNodes[0].innerHTML=q;s.rows[A].childNodes[8].childNodes[0].innerHTML=G;s.rows[A].childNodes[9].childNodes[0].innerHTML=B;s.rows[A].childNodes[11].childNodes[0].innerHTML=p;s.rows[A].childNodes[12].childNodes[0].innerHTML=y;switch(r){case"1":s.rows[A].childNodes[4].childNodes[0].innerHTML="WAN";break;case"2":s.rows[A].childNodes[4].childNodes[0].innerHTML="LAN";break;default:alert("Debugging Mode - tmp_Source");break}switch(o){case"1":s.rows[A].childNodes[7].childNodes[0].innerHTML="WAN";break;case"2":s.rows[A].childNodes[7].childNodes[0].innerHTML="LAN";break;default:alert("Debugging Mode - tmp_Destination");break}switch(n){case"1":s.rows[A].childNodes[10].childNodes[0].innerHTML="TCP";break;case"2":s.rows[A].childNodes[10].childNodes[0].innerHTML="UDP";break;case"3":s.rows[A].childNodes[10].childNodes[0].innerHTML="Any";break;default:alert("Debugging Mode - tmp_Protocol");break}check_TotalRule(Limit_FirewallRules,Total_FirewallRules);return"Success"}function deleteCurrentRow(p){if(IsLoaded){var l=p.parentNode.parentNode;var o=l.parentNode.parentNode;var n=l.sectionRowIndex;var m=new Array(l);deleteRows(m);reorderRows(o,n);Total_FirewallRules-=1;check_TotalRule(Limit_FirewallRules,Total_FirewallRules);save_button_changed()}}function deleteRows(n){if(IsLoaded){for(var l=0;l<n.length;l++){var m=n[l].sectionRowIndex;n[l].parentNode.deleteRow(m)}}}function changeRowIndex(l){var m=document.getElementById(TABLE_NAME);m.rows[l].childNodes[2].childNodes[0].onclick=function(){editData(l)}}function reorderRows(o,n){var o=document.getElementById(TABLE_NAME);if(IsLoaded){if(o.tBodies[0].rows[n]){var m=n+ROW_BASE;for(var l=n;l<o.tBodies[0].rows.length;l++){o.tBodies[0].rows[l].myRow.one.id=NAME+m;o.tBodies[0].rows[l].myRow.two.id=SCHEDULE+m;o.tBodies[0].rows[l].myRow.five.id=SOURCE+m;o.tBodies[0].rows[l].myRow.six.id=SOURCE_ADDRESSRANGE_START+m;o.tBodies[0].rows[l].myRow.seven.id=SOURCE_ADDRESSRANGE_END+m;o.tBodies[0].rows[l].myRow.eight.id=DESTINATION+m;o.tBodies[0].rows[l].myRow.nine.id=DESTINATION_ADDRESSRANGE_START+m;o.tBodies[0].rows[l].myRow.ten.id=DESTINATION_ADDRESSRANGE_END+m;o.tBodies[0].rows[l].myRow.eleven.id=PROTOCOL+m;o.tBodies[0].rows[l].myRow.twelve.id=PORT_RANGE_START+m;o.tBodies[0].rows[l].myRow.thirteen.id=PORT_RANGE_END+m;changeRowIndex(m);m++}}}}function check_TotalRule(l,n){var m=l-n;document.getElementById("RemainingRules").innerHTML=m;if(m==0){document.getElementById("createButton").disabled=true}else{document.getElementById("createButton").disabled=false}};