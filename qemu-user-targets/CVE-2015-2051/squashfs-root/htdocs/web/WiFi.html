<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3c.org/1999/xhtml" xml:lang="zh_TW" lang="zh_TW"> <head> <title>D-LINK</title> <meta http-equiv="X-UA-Compatible" content="IE=9"> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> <meta http-equiv="Content-Type" content="text/css"> <link rel=stylesheet type="text/css" href="/css/jquery.selectbox.css?v=20150211171738"/> <script type="text/javascript" charset="utf-8" src="/js/initialJS.js?v=20150211171738"></script> <script type="text/javascript" charset="utf-8" src="/js/initialCSS.js?v=20150211171738"></script> <script type="text/javascript" charset="utf-8" src="/js/initialJQ.js?v=20150211171738"></script> <script type="text/javascript" charset="utf-8" src="/js/initialValidate1.js?v=20150211171738"></script> <script type="text/javascript" charset="utf-8" src="/js/configuration/DeviceConfig.js?v=20150211171738"></script> <script type="text/javascript">var HNAP=new HNAP_XML();var _ReciprocalNumber=30;var supportmode_24=new Array();var supportmode_5=new Array();var supportmode_5hi=new Array();var supportmode_count_24=0;var supportmode_count_5=0;var supportmode_count_5hi=0;var currentmode=new Array(3);var currentbw=new Array(3);var initoptionlist=new Array(false,false,false);var selected_wlmode;var selected_ssid;var selected_security;var ssid_list=new Array();var ssid_num;var Country_TW=false;var xml_GetDeviceFeature=HNAP.GetXML("GetDeviceFeatureAlpha");var xml_GetOperationMode=HNAP.GetXML("GetOperationMode");var WifiVerify=false;var feature_dualband=xml_GetDeviceFeature.Get("GetDeviceFeatureAlphaResponse/FeatureDualBand");var feature_guestzone=xml_GetDeviceFeature.Get("GetDeviceFeatureAlphaResponse/FeatureGuestZone");var feature_apclient=xml_GetDeviceFeature.Get("GetDeviceFeatureAlphaResponse/FeatureAPClient");var feature_repeater=xml_GetDeviceFeature.Get("GetDeviceFeatureAlphaResponse/FeatureRepeater");var feature_extender=xml_GetDeviceFeature.Get("GetDeviceFeatureAlphaResponse/FeatureExtender");var device_layout=xml_GetOperationMode.Get("GetOperationModeResponse/OperationModeList/CurrentOPMode");var support_apclient=false;var support_repeater=false;var support_apmode=false;var support_5g_hi=false;if(feature_dualband=="true"){feature_dualband=true}else{feature_dualband=false}if(feature_guestzone=="true"){feature_guestzone=true}else{feature_guestzone=false}if(device_layout=="WirelessBridge"){if(feature_apclient=="true"){support_apclient=true}if(feature_repeater=="true"){support_repeater=true}}else{if(device_layout=="WirelessRepeaterExtender"){support_repeater=true}else{if(device_layout=="WirelessAp"){support_apmode=true}}}function BandToIndex(a){if(a=="24"){return 0}else{if(a=="5"){return 1}else{if(a=="5hi"){return 2}else{return"Error Band"}}}}function Load_HTML(){$("#header").load("header.html")}function Initial(){initialMenu();initialDetectRouterConnection()}function AddSelectOpt(c,a,b){$(c).append('<option value="'+a+'">'+b+"</option>")}function SupportMode(d,c){var b=0;for(var a=0;a<supportmode_count_24;a++){if(c==supportmode_24[a]){b=1}}for(var a=0;a<supportmode_count_5;a++){if(c==supportmode_5[a]){b=1}}if(b!=1){return}switch(c){case"802.11a":AddSelectOpt(d,c,"802.11a only");break;case"802.11b":AddSelectOpt(d,c,"802.11b only");break;case"802.11g":AddSelectOpt(d,c,"802.11g only");break;case"802.11n":AddSelectOpt(d,c,"802.11n only");break;case"802.11bg":AddSelectOpt(d,c,"Mixed 802.11b/g");break;case"802.11gn":AddSelectOpt(d,c,"Mixed 802.11g/n");break;case"802.11bgn":AddSelectOpt(d,c,"Mixed 802.11b/g/n");break;case"802.11an":AddSelectOpt(d,c,"Mixed 802.11a/n");break;case"802.11ac":AddSelectOpt(d,c,"802.11ac only");break;case"802.11nac":AddSelectOpt(d,c,"Mixed 802.11n/ac");break;case"802.11anac":AddSelectOpt(d,c,"Mixed 802.11a/n/ac");break}}function GetRadioInfo(){var u=document.getElementById("channel_24");var s=document.getElementById("channel_5");var C=document.getElementById("channel_5hi");var E=document.getElementById("security_24");var g=document.getElementById("security_5");var t=document.getElementById("security_5hi");var p=document.getElementById("schedule_24");var f=document.getElementById("schedule_5");var o=document.getElementById("schedule_5hi");var w=HNAP.GetXML("GetWLanRadios_Alpha");var B=w.Get("GetWLanRadiosResponse/RadioInfos/RadioInfo#");var h=false;var e=false;var r=false;var q=false;for(var y=1;y<=B;y++){var m=w.Get("GetWLanRadiosResponse/RadioInfos/RadioInfo:"+y+"/RadioID");var D=w.Get("GetWLanRadiosResponse/RadioInfos/RadioInfo:"+y+"/SupportedModes/string#");for(var v=1;v<=D;v++){var b=w.Get("GetWLanRadiosResponse/RadioInfos/RadioInfo:"+y+"/SupportedModes/string:"+v);if(m=="2.4GHZ"){supportmode_24[supportmode_count_24]=b;supportmode_count_24++}else{if(m=="5GHZ"){supportmode_5[supportmode_count_5]=b;supportmode_count_5++}else{if(m=="RADIO_5GHz_2"){support_5g_hi=true;supportmode_5hi[supportmode_count_5hi]=b;supportmode_count_5hi++}}}}var n=w.Get("GetWLanRadiosResponse/RadioInfos/RadioInfo:"+y+"/Channels/int#");for(var v=1;v<=n;v++){var F=w.Get("GetWLanRadiosResponse/RadioInfos/RadioInfo:"+y+"/Channels/int:"+v);if(m=="2.4GHZ"){u.options.add(new Option(F,F))}else{if(m=="5GHZ"){s.options.add(new Option(F,F));if(F=="52"){h=true}else{if(F=="56"){e=true}else{if(F=="60"){r=true}else{if(F=="64"){q=true}}}}}else{if(m=="RADIO_5GHz_2"&&support_5g_hi){C.options.add(new Option(F,F))}}}}if(m=="5GHZ"&&!h&&e&&r&&q){Country_TW=true}var A=w.Get("GetWLanRadiosResponse/RadioInfos/RadioInfo:"+y+"/SupportedSecurity/SecurityInfo#");for(var v=1;v<=A;v++){var d=w.Get("GetWLanRadiosResponse/RadioInfos/RadioInfo:"+y+"/SupportedSecurity/SecurityInfo:"+v+"/SecurityType");if(d=="WPA-Personal"){d="WPA/WPA2-Personal"}if(m=="2.4GHZ"){E.options.add(new Option(d,d))}else{if(m=="5GHZ"){g.options.add(new Option(d,d))}else{if(m=="RADIO_5GHz_2"&&support_5g_hi){t.options.add(new Option(d,d))}}}}var c=HNAP.GetXML("GetScheduleSettings");var x=c.Get("GetScheduleSettingsResponse/ScheduleInfoLists#");for(var v=1;v<=x;v++){var z=c.Get("GetScheduleSettingsResponse/ScheduleInfoLists:"+v+"/ScheduleName");if(m=="2.4GHZ"){p.options.add(new Option(z,z))}else{if(m=="5GHZ"){f.options.add(new Option(z,z))}else{if(m=="RADIO_5GHz_2"&&support_5g_hi){o.options.add(new Option(z,z))}}}}}var k=HNAP.GetXML("GetWiFiVerifyAlpha");var l=k.Get("GetWiFiVerifyAlphaResponse/WPS/Enable");var a=k.Get("GetWiFiVerifyAlphaResponse/WPS/Configured");if(k.Get("GetWiFiVerifyAlphaResponse/Wifiverify")==1){WifiVerify=true;document.getElementById("wpspage").style.display="block"}if(l=="Disable"){document.getElementById("pbc_button").disabled=true;document.getElementById("pin_button").disabled=true;document.getElementById("pin_num").disabled=true}else{document.getElementById("pbc_button").disabled=false;document.getElementById("pin_button").disabled=false;document.getElementById("pin_num").disabled=false}if(a=="Unconfigured"){document.getElementById("ResetWPS").disabled=true}else{document.getElementById("ResetWPS").disabled=false}document.getElementById("dev_pin").value=k.Get("GetWiFiVerifyAlphaResponse/WPS/PIN");document.getElementById("wps_status").innerHTML=l+"/"+a}function InitWLanValue(r,p){var e=HNAP.GetXML("GetWLanRadioSettings",new Array("RadioID",r));var j=e.Get("GetWLanRadioSettingsResponse/SSID");document.getElementById("wifiName_"+p).value=j;var z=e.Get("GetWLanRadioSettingsResponse/Channel");var v=document.getElementById("channel_"+p);COMM_SetSelectValue(v,z);var g=e.Get("GetWLanRadioSettingsResponse/SSIDBroadcast");var x=document.getElementById("visibilityStatus_"+p);COMM_SetSelectValue(x,g);var t=e.Get("GetWLanRadioSettingsResponse/TXPower");var n=document.getElementById("transmissionPower_"+p);COMM_SetSelectValue(n,t);var w=e.Get("GetWLanRadioSettingsResponse/Schedule");var h=document.getElementById("schedule_"+p);COMM_SetSelectValue(h,w);var m=HNAP.GetXML("GetWLanRadioSecurity",new Array("RadioID",r));var l=m.Get("GetWLanRadioSecurityResponse/Enabled");var d=m.Get("GetWLanRadioSecurityResponse/Type");var q=m.Get("GetWLanRadioSecurityResponse/Encryption");var b="";var s=document.getElementById("security_"+p);if(l!="false"){var a=m.Get("GetWLanRadioSecurityResponse/Key");var y=0;for(var u=0;u<s.options.length;u++){if(s.options[u].value=="WPA/WPA2-Personal"||s.options[u].value=="WEP"){y=1}}if(y){if(d=="WPA-PSK"||d=="WPA2-PSK"||d=="WPAORWPA2-PSK"){b="WPA/WPA2-Personal"}else{b="WEP"}}else{b=d;if(d=="WPA-PSK"){b="WPA"}else{if(d=="WPA2-PSK"){b="WPA2"}else{if(d=="WPAORWPA2-PSK"){b="WPA+WPA2"}}}if(q=="TKIP"){b=b+"-TKIP"}else{if(q=="AES"){b=b+"-AES"}else{if(q=="TKIPORAES"){b=b+"-TKIP+AES"}}}}document.getElementById("password_"+p).disabled=false;document.getElementById("password_"+p).value=a}else{b="None";document.getElementById("password_"+p).disabled=true}COMM_SetSelectValue(s,b);var o=e.Get("GetWLanRadioSettingsResponse/Mode");var f=document.getElementById("80211Mode_"+p);currentmode[BandToIndex(p)]=o;var k=e.Get("GetWLanRadioSettingsResponse/ChannelWidth");var c=document.getElementById("channelWidth_"+p);currentbw[BandToIndex(p)]=k;ChangeSupportModeList(b,p);initoptionlist[BandToIndex(p)]=true;$("#security_"+p).selectbox();$("#80211Mode_"+p).selectbox("detach");$("#80211Mode_"+p).selectbox();$("#channel_"+p).selectbox();$("#transmissionPower_"+p).selectbox();$("#channelWidth_"+p).selectbox("detach");$("#channelWidth_"+p).selectbox();$("#visibilityStatus_"+p).selectbox();$("#schedule_"+p).selectbox();var l=e.Get("GetWLanRadioSettingsResponse/Enabled");if(l=="true"){SetCheckBoxEnable("status_"+p,true,true);DisableSettings(p,false)}else{SetCheckBoxEnable("status_"+p,true,false);DisableSettings(p,true)}}function InitWIFISTA(){var i=HNAP.GetXML("GetAPClientSettings");var d=i.Get("GetAPClientSettingsResponse/SSID");document.getElementById("apclient_ssid").value=d;var c=document.getElementById("apclient_security");var g=i.Get("GetAPClientSettingsResponse/SupportedSecurity/SecurityInfo/SecurityType");var f;if(g.indexOf("WPA")>=0){f="WPA+2PSK"}else{if(g.indexOf("WEP")>=0){f="WEP"}else{f="NONE"}}COMM_SetSelectValue(c,f);ChangeSecurity(f);if(f!="NONE"){var h=i.Get("GetAPClientSettingsResponse/Key");document.getElementById("apclient_passwd").value=h;if(f=="WEP"){var b=h.length;var e=document.getElementById("apclient_wep_passlen");var a;if(h.length==10){a="64Hex"}else{if(h.length==5){a="64ASCII"}else{if(h.length==26){a="128Hex"}else{if(h.length==13){a="128ASCII"}}}}COMM_SetSelectValue(e,a)}}$("#apclient_security").selectbox();$("#apclient_wep_passlen").selectbox()}function InitSmartConnectValue(){$("#security_smartconnect").selectbox("detach");$("#transmissionPower_smartconnect").selectbox("detach");$("#schedule_smartconnect").selectbox("detach");var s=HNAP.GetXML("GetWLanRadios_Alpha");var p=document.getElementById("security_smartconnect");var x=s.Get("GetWLanRadiosResponse/RadioInfos/RadioInfo#");for(var u=1;u<=x;u++){var k=s.Get("GetWLanRadiosResponse/RadioInfos/RadioInfo:"+u+"/RadioID");var w=s.Get("GetWLanRadiosResponse/RadioInfos/RadioInfo:"+u+"/SupportedSecurity/SecurityInfo#");if(k=="2.4GHZ"){for(var r=1;r<=w;r++){var c=s.Get("GetWLanRadiosResponse/RadioInfos/RadioInfo:"+u+"/SupportedSecurity/SecurityInfo:"+r+"/SecurityType");if(c=="WPA-Personal"){c="WPA/WPA2-Personal"}p.options.add(new Option(c,c))}}}var n=HNAP.GetXML("GetWLanRadioSecurity",new Array("RadioID","RADIO_2.4GHz"));var f=HNAP.GetXML("GetWLanRadioSettings",new Array("RadioID","RADIO_2.4GHz"));var h=f.Get("GetWLanRadioSettingsResponse/SSID");document.getElementById("wifiName_smartconnect").value=h;var e=n.Get("GetWLanRadioSecurityResponse/Type");var o=n.Get("GetWLanRadioSecurityResponse/Encryption");var c="";var b=n.Get("GetWLanRadioSecurityResponse/Key");var l=n.Get("GetWLanRadioSecurityResponse/Enabled");var e=n.Get("GetWLanRadioSecurityResponse/Type");var o=n.Get("GetWLanRadioSecurityResponse/Encryption");var c="";var p=document.getElementById("security_smartconnect");if(l!="false"){var b=n.Get("GetWLanRadioSecurityResponse/Key");if(e=="WPA-PSK"||e=="WPA2-PSK"||e=="WPAORWPA2-PSK"){c="WPA/WPA2-Personal"}else{c="WEP"}document.getElementById("password_smartconnect").disabled=false;document.getElementById("password_smartconnect").value=b}else{c="None";document.getElementById("password_smartconnect").disabled=true}var a=document.getElementById("schedule_smartconnect");var d=HNAP.GetXML("GetScheduleSettings");var t=d.Get("GetScheduleSettingsResponse/ScheduleInfoLists#");for(var r=1;r<=t;r++){var v=d.Get("GetScheduleSettingsResponse/ScheduleInfoLists:"+r+"/ScheduleName");a.options.add(new Option(v,v))}var q=f.Get("GetWLanRadioSettingsResponse/TXPower");var m=document.getElementById("transmissionPower_smartconnect");COMM_SetSelectValue(m,q);var v=f.Get("GetWLanRadioSettingsResponse/Schedule");var g=document.getElementById("schedule_smartconnect");COMM_SetSelectValue(g,v);COMM_SetSelectValue(p,c);$("#security_smartconnect").selectbox();$("#transmissionPower_smartconnect").selectbox();$("#schedule_smartconnect").selectbox()}function InitWLAN(){if(feature_guestzone){document.getElementById("FUNC_Guest").style.display="block"}else{document.getElementById("FUNC_Guest").style.display="none"}var b=HNAP.GetXML("GetSmartconnectSettings");var a=b.Get("GetSmartconnectSettingsResponse/Enabled");if(support_apclient){document.getElementById("WIFI_STA").style.display="block";document.getElementById("SMART_CONNECT").style.display="none";document.getElementById("separated_line").style.display="none";document.getElementById("RADIO_2GHz").style.display="none";document.getElementById("RADIO_5GHz").style.display="none";document.getElementById("RADIO_5GHz_hi").style.display="none";document.getElementById("FUNC_Guest").style.display="none";InitWIFISTA()}else{if(support_repeater){document.getElementById("WIFI_STA").style.display="block";document.getElementById("SMART_CONNECT").style.display="none";document.getElementById("separated_line").style.display="block";document.getElementById("RADIO_2GHz").style.display="block";document.getElementById("FUNC_Guest").style.display="none";InitWIFISTA();InitWLanValue("RADIO_2.4GHz","24");if(feature_dualband){document.getElementById("RADIO_5GHz").style.display="block";InitWLanValue("RADIO_5GHz","5");if(support_5g_hi){document.getElementById("RADIO_5GHz_hi").style.display="block";InitWLanValue("RADIO_5GHz_2","5hi")}}}else{if(support_apmode){document.getElementById("FUNC_Guest").style.display="none"}if(a=="true"){document.getElementById("WIFI_STA").style.display="none";document.getElementById("SMART_CONNECT").style.display="block";document.getElementById("smartconnect_ssid_tr").style.display="table-row";document.getElementById("smartconnect_passwd_tr").style.display="table-row";document.getElementById("smartconnect_line").style.display="block";document.getElementById("separated_line").style.display="none";document.getElementById("RADIO_2GHz").style.display="none";document.getElementById("RADIO_5GHz").style.display="none";document.getElementById("RADIO_5GHz_hi").style.display="none";SetCheckBoxEnable("status_smartconnect",true,true);DisableSettings("smartconnect",false);InitSmartConnectValue()}else{document.getElementById("SMART_CONNECT").style.display="block";document.getElementById("smartconnect_ssid_tr").style.display="none";document.getElementById("smartconnect_passwd_tr").style.display="none";document.getElementById("smartconnect_line").style.display="none";document.getElementById("separated_line").style.display="none";SetCheckBoxEnable("status_smartconnect",true,false);DisableSettings("smartconnect",true);document.getElementById("WIFI_STA").style.display="none";document.getElementById("separated_line").style.display="none";document.getElementById("RADIO_2GHz").style.display="block";InitWLanValue("RADIO_2.4GHz","24");if(feature_dualband){document.getElementById("RADIO_5GHz").style.display="block";InitWLanValue("RADIO_5GHz","5");if(support_5g_hi){document.getElementById("RADIO_5GHz_hi").style.display="block";InitWLanValue("RADIO_5GHz_2","5hi")}}}$("#security_smartconnect").selectbox();$("#transmissionPower_smartconnect").selectbox();$("#schedule_smartconnect").selectbox()}}}function CheckConnectionStatus(){$.ajax({cache:false,url:"./js/CheckConnection",timeout:2000,type:"GET",success:function(a){SaveWLAN()},error:function(){document.getElementById("DetectRouterConnection").style.display="inline"}})}function SaveSmartConnectValue(a,m){var g=HNAP.GetXML("SetWLanRadioSettings");var b=HNAP.GetXML("SetSmartconnectSettings");g.Set("SetWLanRadioSettings/RadioID",a);var h=document.getElementById("status_"+m+"_ck").checked;if(h=="1"){g.Set("SetWLanRadioSettings/Enabled","true");b.Set("SetSmartconnectSettings/Enabled","true")}else{g.Set("SetWLanRadioSettings/Enabled","true");b.Set("SetSmartconnectSettings/Enabled","false")}var o=document.getElementById("wifiName_"+m).value;g.Set("SetWLanRadioSettings/SSID",o);g.Set("SetWLanRadioSettings/Mode","802.11bgn");g.Set("SetWLanRadioSettings/Channel","Auto");var k=document.getElementById("transmissionPower_"+m).value;g.Set("SetWLanRadioSettings/TXPower",k);g.Set("SetWLanRadioSettings/ChannelWidth","0");g.Set("SetWLanRadioSettings/SSIDBroadcast","true");var i=document.getElementById("schedule_"+m).value;g.Set("SetWLanRadioSettings/Schedule",i);var f=HNAP.SetXMLAsync("SetWLanRadioSettings",g);var n=HNAP.GetXML("SetWLanRadioSecurity");n.Set("SetWLanRadioSecurity/RadioID",a);var c=document.getElementById("security_"+m).value;var l=document.getElementById("password_"+m).value;var e;if(l.length==5||l.length==10){e="WEP-64"}else{if(l.length==13||l.length==26){e="WEP-128"}}switch(c){case"None":n.Set("SetWLanRadioSecurity/Enabled","false");break;case"WEP":n.Set("SetWLanRadioSecurity/Enabled","true");n.Set("SetWLanRadioSecurity/Type","WEP-SHARED");n.Set("SetWLanRadioSecurity/Encryption",e);n.Set("SetWLanRadioSecurity/Key",l);n.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA/WPA2-Personal":n.Set("SetWLanRadioSecurity/Enabled","true");n.Set("SetWLanRadioSecurity/Type","WPAORWPA2-PSK");n.Set("SetWLanRadioSecurity/Encryption","TKIPORAES");n.Set("SetWLanRadioSecurity/Key",l);n.Set("SetWLanRadioSecurity/KeyRenewal","3600");break}var d=HNAP.SetXMLAsync("SetSmartconnectSettings",b);var j=HNAP.SetXMLAsync("SetWLanRadioSecurity",n)}function SaveWLanValue(b,o){var g=HNAP.GetXML("SetWLanRadioSettings");g.Set("SetWLanRadioSettings/RadioID",b);var h=document.getElementById("status_"+o+"_ck").checked;if(h=="1"){g.Set("SetWLanRadioSettings/Enabled","true")}else{g.Set("SetWLanRadioSettings/Enabled","false")}var q=document.getElementById("wifiName_"+o).value;g.Set("SetWLanRadioSettings/SSID",q);var d=document.getElementById("80211Mode_"+o).value;g.Set("SetWLanRadioSettings/Mode",d);var k=document.getElementById("channel_"+o).value;g.Set("SetWLanRadioSettings/Channel",k);var m=document.getElementById("transmissionPower_"+o).value;g.Set("SetWLanRadioSettings/TXPower",m);var a=document.getElementById("channelWidth_"+o).value;g.Set("SetWLanRadioSettings/ChannelWidth",a);var j=document.getElementById("visibilityStatus_"+o).value;g.Set("SetWLanRadioSettings/SSIDBroadcast",j);var i=document.getElementById("schedule_"+o).value;g.Set("SetWLanRadioSettings/Schedule",i);var f=HNAP.SetXMLAsync("SetWLanRadioSettings",g);var p=HNAP.GetXML("SetWLanRadioSecurity");p.Set("SetWLanRadioSecurity/RadioID",b);var c=document.getElementById("security_"+o).value;var n=document.getElementById("password_"+o).value;var e;if(n.length==5||n.length==10){e="WEP-64"}else{if(n.length==13||n.length==26){e="WEP-128"}}switch(c){case"None":p.Set("SetWLanRadioSecurity/Enabled","false");break;case"WEP":p.Set("SetWLanRadioSecurity/Enabled","true");p.Set("SetWLanRadioSecurity/Type","WEP-SHARED");p.Set("SetWLanRadioSecurity/Encryption",e);p.Set("SetWLanRadioSecurity/Key",n);p.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA/WPA2-Personal":p.Set("SetWLanRadioSecurity/Enabled","true");p.Set("SetWLanRadioSecurity/Type","WPAORWPA2-PSK");p.Set("SetWLanRadioSecurity/Encryption","TKIPORAES");p.Set("SetWLanRadioSecurity/Key",n);p.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WEP-SHARED":p.Set("SetWLanRadioSecurity/Enabled","true");p.Set("SetWLanRadioSecurity/Type","WEP-SHARED");p.Set("SetWLanRadioSecurity/Encryption",e);p.Set("SetWLanRadioSecurity/Key",n);p.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WEP-AUTO":p.Set("SetWLanRadioSecurity/Enabled","true");p.Set("SetWLanRadioSecurity/Type","WEP-AUTO");p.Set("SetWLanRadioSecurity/Encryption",e);p.Set("SetWLanRadioSecurity/Key",n);p.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA-TKIP":p.Set("SetWLanRadioSecurity/Enabled","true");p.Set("SetWLanRadioSecurity/Type","WPA-PSK");p.Set("SetWLanRadioSecurity/Encryption","TKIP");p.Set("SetWLanRadioSecurity/Key",n);p.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA-AES":p.Set("SetWLanRadioSecurity/Enabled","true");p.Set("SetWLanRadioSecurity/Type","WPA-PSK");p.Set("SetWLanRadioSecurity/Encryption","AES");p.Set("SetWLanRadioSecurity/Key",n);p.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA-TKIP+AES":p.Set("SetWLanRadioSecurity/Enabled","true");p.Set("SetWLanRadioSecurity/Type","WPA-PSK");p.Set("SetWLanRadioSecurity/Encryption","TKIPORAES");p.Set("SetWLanRadioSecurity/Key",n);p.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA2-TKIP":p.Set("SetWLanRadioSecurity/Enabled","true");p.Set("SetWLanRadioSecurity/Type","WPA2-PSK");p.Set("SetWLanRadioSecurity/Encryption","TKIP");p.Set("SetWLanRadioSecurity/Key",n);p.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA2-AES":p.Set("SetWLanRadioSecurity/Enabled","true");p.Set("SetWLanRadioSecurity/Type","WPA2-PSK");p.Set("SetWLanRadioSecurity/Encryption","AES");p.Set("SetWLanRadioSecurity/Key",n);p.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA2-TKIP+AES":p.Set("SetWLanRadioSecurity/Enabled","true");p.Set("SetWLanRadioSecurity/Type","WPA2-PSK");p.Set("SetWLanRadioSecurity/Encryption","TKIPORAES");p.Set("SetWLanRadioSecurity/Key",n);p.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA+WPA2-TKIP":p.Set("SetWLanRadioSecurity/Enabled","true");p.Set("SetWLanRadioSecurity/Type","WPAORWPA2-PSK");p.Set("SetWLanRadioSecurity/Encryption","TKIP");p.Set("SetWLanRadioSecurity/Key",n);p.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA+WPA2-AES":p.Set("SetWLanRadioSecurity/Enabled","true");p.Set("SetWLanRadioSecurity/Type","WPAORWPA2-PSK");p.Set("SetWLanRadioSecurity/Encryption","AES");p.Set("SetWLanRadioSecurity/Key",n);p.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA+WPA2-TKIP+AES":p.Set("SetWLanRadioSecurity/Enabled","true");p.Set("SetWLanRadioSecurity/Type","WPAORWPA2-PSK");p.Set("SetWLanRadioSecurity/Encryption","TKIPORAES");p.Set("SetWLanRadioSecurity/Key",n);p.Set("SetWLanRadioSecurity/KeyRenewal","3600");break}var l=HNAP.SetXMLAsync("SetWLanRadioSecurity",p)}function checkwarning(c){var a=document.getElementById("security_"+c).value;if((c=="5"||c=="5hi")&&!feature_dualband){return true}else{var b=true;if(a=="None"&&WifiVerify){if(c=="24"){c="2.4"}b=confirm("Warning ! By selecting None in Security Mode will make your "+c+"GHz wifi connection vulnerable. Proceed ?")}return b}}function checkvisibility(c){var a=document.getElementById("visibilityStatus_"+c).value;if((c=="5"||c=="5hi")&&!feature_dualband){return true}else{var b=true;if(a=="false"&&WifiVerify){b=confirm("Warning ! WSC will be disabled by selecting Invisible in Visibility Status. Proceed ?")}return b}}function SaveWLAN(){var d=document.getElementById("SMART_CONNECT").style.display;if(d=="block"){var b=document.getElementById("status_smartconnect_ck").checked;if((!checkwarning("24")||!checkwarning("5")||!checkwarning("5hi")||!checkvisibility("24")||!checkvisibility("5")||!checkvisibility("5hi"))&&WifiVerify){alert("This page won't be saved.");return}if(b=="1"){SaveSmartConnectValue("RADIO_2.4GHz","smartconnect")}else{var c=HNAP.GetXML("SetSmartconnectSettings");c.Set("SetSmartconnectSettings/Enabled","false");var a=HNAP.SetXMLAsync("SetSmartconnectSettings",c);SaveWLanValue("RADIO_2.4GHz","24");if(feature_dualband){setTimeout('SaveWLanValue("RADIO_5GHz", "5")',1000);if(support_5g_hi){setTimeout('SaveWLanValue("RADIO_5GHz_2", "5hi")',2000)}}}}else{if(support_apclient){SaveAPClientValue()}else{if(support_repeater){SaveAPClientValue();SaveWLanValue("RADIO_2.4GHz","24");if(feature_dualband){SaveWLanValue("RADIO_5GHz","5");if(support_5g_hi){SaveWLanValue("RADIO_5GHz_2","5hi")}}}else{if(support_apmode){SaveWLanValue("RADIO_2.4GHz","24");if(feature_dualband){SaveWLanValue("RADIO_5GHz","5");if(support_5g_hi){SaveWLanValue("RADIO_5GHz_2","5hi")}}}}}}document.getElementById("CreatePopAlertMessage").style.display="inline";document.getElementById("waitSettingFinish").style.display="inline";Start_reciprocal_Number_RestoreConfiguration()}function CheckSupportN(d){var a;var b=document.getElementById("security_"+d).value;var c=document.getElementById("80211Mode_"+d).value;if(b=="WEP"||b=="WEP-OPEN"||b=="WEP-SHARED"||b=="WEP-AUTO"||b=="WPA-TKIP"||b=="WPA2-TKIP"||b=="WPA+WPA2-TKIP"){a=false}else{if(c=="802.11a"||c=="802.11b"||c=="802.11g"){a=false}else{a=true}}return a}function CheckSupportBW(d,a){var c;var b=document.getElementById("security_"+d).value;if(!CheckSupportN(d)||a==12||a==13||a==140||a==165||a==116){c="20"}else{if(a==132||a==136){c="40"}else{if(d=="5"&&Country_TW){if(a==56){c="20"}else{c="40"}}else{c="80"}}}return c}function ChangePasswordInput(a){if(a=="None"){document.getElementById("password_smartconnect").disabled=true}else{document.getElementById("password_smartconnect").disabled=false}}function ChangeSupportModeList(b,c){var a=document.getElementById("80211Mode_"+c);if(initoptionlist[BandToIndex(c)]){currentmode[BandToIndex(c)]=a.value}$("#80211Mode_"+c).selectbox("detach");$("#80211Mode_"+c).children().remove();if(b=="None"){document.getElementById("password_"+c).disabled=true}else{document.getElementById("password_"+c).disabled=false}switch(c){case"24":SupportMode("#80211Mode_"+c,"802.11b");SupportMode("#80211Mode_"+c,"802.11g");SupportMode("#80211Mode_"+c,"802.11bg");if(CheckSupportN(c)){SupportMode("#80211Mode_"+c,"802.11n")}SupportMode("#80211Mode_"+c,"802.11gn");SupportMode("#80211Mode_"+c,"802.11bgn");break;case"5":case"5hi":if(CheckSupportN(c)){SupportMode("#80211Mode_"+c,"802.11a");SupportMode("#80211Mode_"+c,"802.11n");SupportMode("#80211Mode_"+c,"802.11an");SupportMode("#80211Mode_"+c,"802.11ac");SupportMode("#80211Mode_"+c,"802.11nac");SupportMode("#80211Mode_"+c,"802.11anac")}else{SupportMode("#80211Mode_"+c,"802.11a");SupportMode("#80211Mode_"+c,"802.11an");SupportMode("#80211Mode_"+c,"802.11anac")}break}COMM_SetSelectValue(a,currentmode[BandToIndex(c)]);$("#80211Mode_"+c).selectbox("attach");ChangeWidthList(c)}function ChangeWidthList(e){var a=document.getElementById("channelWidth_"+e);if(initoptionlist[BandToIndex(e)]){currentbw[BandToIndex(e)]=a.value}$("#channelWidth_"+e).selectbox("detach");$("#channelWidth_"+e).children().remove();var c=document.getElementById("security_"+e).value;var d=document.getElementById("80211Mode_"+e).value;var b=document.getElementById("channel_"+e).value;if(e=="24"||((e=="5"||e=="5hi")&&CheckSupportBW(e,b)=="20")){AddSelectOpt("#channelWidth_"+e,"20","20 MHz")}if((/ac/.test(d)||/n/.test(d))&&(CheckSupportBW(e,b)!="20")){AddSelectOpt("#channelWidth_"+e,"0","Auto 20/40 MHz")}if(/ac/.test(d)&&(CheckSupportBW(e,b)=="80")){AddSelectOpt("#channelWidth_"+e,"1","Auto 20/40/80 MHz")}COMM_SetSelectValue(a,currentbw[BandToIndex(e)]);$("#channelWidth_"+e).selectbox("attach")}function DisableSettings(c,b){document.getElementById("wifiName_"+c).disabled=b;document.getElementById("password_"+c).disabled=b;var a;if(b){a="disable"}else{a="enable"}if(c!="smartconnect"){$("#80211Mode_"+c).selectbox(a);$("#channel_"+c).selectbox(a);$("#channelWidth_"+c).selectbox(a);$("#visibilityStatus_"+c).selectbox(a)}$("#security_"+c).selectbox(a);$("#transmissionPower_"+c).selectbox(a);$("#schedule_"+c).selectbox(a)}function ChangeBandStatus(d){var e="status_"+d;var b="status_"+d+"_ck";SetCheckBoxEnable(e);var a=document.getElementById("status_"+d+"_ck").checked;if(d=="smartconnect"){if(a){document.getElementById("SMART_CONNECT").style.display="block";document.getElementById(d+"_ssid_tr").style.display="table-row";document.getElementById(d+"_passwd_tr").style.display="table-row";document.getElementById(d+"_line").style.display="block";document.getElementById("SMART_CONNECT_adv").style.display="none";document.getElementById("WIFI_STA").style.display="none";document.getElementById("separated_line").style.display="none";document.getElementById("RADIO_2GHz").style.display="none";if(feature_dualband){document.getElementById("RADIO_5GHz").style.display="none";document.getElementById("RADIO_5GHz_hi").style.display="none"}InitSmartConnectValue();DisableSettings(d,false);var c=document.getElementById("security_"+d).value;if(c=="None"){document.getElementById("password_"+d).disabled=true}}else{document.getElementById("SMART_CONNECT").style.display="block";document.getElementById(d+"_ssid_tr").style.display="none";document.getElementById(d+"_passwd_tr").style.display="none";document.getElementById(d+"_line").style.display="none";document.getElementById("SMART_CONNECT_adv").style.display="none";document.getElementById("WIFI_STA").style.display="none";document.getElementById("separated_line").style.display="none";document.getElementById("RADIO_2GHz").style.display="block";InitWLanValue("RADIO_2.4GHz","24");if(feature_dualband){document.getElementById("RADIO_5GHz").style.display="block";InitWLanValue("RADIO_5GHz","5");if(support_5g_hi){document.getElementById("RADIO_5GHz_hi").style.display="block";InitWLanValue("RADIO_5GHz_2","5hi")}}}}else{if(a){DisableSettings(d,false)}else{DisableSettings(d,true)}var c=document.getElementById("security_"+d).value;if(c=="None"){document.getElementById("password_"+d).disabled=true}}}function AddSiteSurveyLists(b){var c=HNAP.GetXML("GetSiteSurvey",new Array("RadioID",b));var f=c.Get("GetSiteSurveyResponse/APStatInfoLists/APStatInfo#");for(var e=1;e<=f;e++){var a=c.Get("GetSiteSurveyResponse/APStatInfoLists/APStatInfo:"+e+"/SSID");var h=c.Get("GetSiteSurveyResponse/APStatInfoLists/APStatInfo:"+e+"/SignalStrength");var n=c.Get("GetSiteSurveyResponse/APStatInfoLists/APStatInfo:"+e+"/SupportedSecurity/SecurityInfo/SecurityType");var l=c.Get("GetSiteSurveyResponse/APStatInfoLists/APStatInfo:"+e+"/MacAddress");var m="";var k="";var g="";if(b=="5GHZ"){g="5"}else{if(b=="2.4GHZ"){g="24"}}if(n!="NONE"){m='<img src="image/wisp_security.png" width="12" height="21"/>'}else{m=""}if(parseInt(h)<=35){k='<img src="image/wisp_strength_low.png" width="25" height="20"/>'}else{if(parseInt(h)<=70&&parseInt(h)>35){k='<img src="image/wisp_strength_medium.png" width="25" height="20"/>'}else{if(parseInt(h)<=100&&parseInt(h)>70){k='<img src="image/wisp_strength_high.png" width="25" height="20"/>'}}}if(ssid_num>0){for(var d=0;d<=ssid_num-1;d++){if(a==ssid_list[d].ssid&&l==ssid_list[d].mac){return}}}ssid_list[ssid_num]={ssid:a,mac:l,rssi_img:k,sec_img:m,sec_type:n,rssi_value:parseInt(h),wl_mode:g};ssid_num++}}function SortSiteSurveyList(){function a(d,c){if(d.rssi_value<c.rssi_value){return 1}if(d.rssi_value>c.rssi_value){return -1}return 0}ssid_list.sort(a)}function ChangeBgcolor(a,c){var e=document.getElementById(a).getElementsByTagName("tr");for(var b=0;b<e.length;b++){var d=e[b].getAttribute("id");if(d==c){document.getElementById(c).style.backgroundColor="#CCC"}else{document.getElementById(d).style.backgroundColor="#FFF"}}}function InjectTable(d,e,b,g){var k=document.getElementById(d).getElementsByTagName("tr");var a=null;var h=null;var c;var f;var j=false;selected_wlmode=null;selected_ssid=null;selected_security=null;for(c=0;!j&&c<k.length;c++){if(k[c].id==e){j=true}}if(j){for(c=0;c<b.length;c++){h=document.getElementById(e+"_"+c);switch(g[c]){case"text":f=b[c];if(typeof(h.innerText)!=="undefined"){h.innerText=f}else{if(typeof(h.textContent)!=="undefined"){h.textContent=f}else{h.innerHTML=f}}break;default:f=b[c];h.innerHTML=f;break}}return}a=document.getElementById(d).insertRow(k.length);a.id=e;a.onclick=function(i){selected_wlmode=b[4];selected_ssid=b[0];if(b[3]=="NONE"){selected_security="NONE"}else{if(b[3].indexOf("WEP")==0){selected_security="WEP"}else{selected_security="WPA+2PSK"}}ChangeBgcolor(d,e)};for(c=0;c<b.length-2;c++){h=a.insertCell(c);h.id=e+"_"+c;h.className="content";switch(g[c]){case"text":f=b[c];if(typeof(h.innerText)!=="undefined"){h.innerText=f}else{if(typeof(h.textContent)!=="undefined"){h.textContent=f}else{h.innerHTML=f}}break;default:f=b[c];h.innerHTML=f;break}}}function DrawSiteSurveyList(){var h=Math.floor((Math.random()*10)+1);SortSiteSurveyList();for(var d=0;d<ssid_list.length;d++){var a=ssid_list[d].ssid;var g=ssid_list[d].rssi_img;var b=ssid_list[d].sec_img;var j=ssid_list[d].sec_type;var e=ssid_list[d].wl_mode;var c=[a,g,b,j,e];var f=["text","img","img","text","text"];InjectTable("content_tb","hotspot"+h+"-"+d,c,f)}document.getElementById("scan_wifi_list_block").style.display="block";document.getElementById("scan_waiting").style.display="none";document.getElementById("scan_list").style.display="block"}function ShowSiteSurveyLists(a,b){CleanTable("content_tb");ssid_num=0;if(a=="OK"){AddSiteSurveyLists("5GHZ");AddSiteSurveyLists("2.4GHZ");DrawSiteSurveyList()}else{setTimeout("EventSiteSurvey()",b*1000)}}function EventSiteSurvey(){var b=HNAP.GetXML("SetTriggerWirelessSiteSurvey");b.Set("SetTriggerWirelessSiteSurvey/RadioID","RADIO_2.4GHz");var a=HNAP.SetXML("SetTriggerWirelessSiteSurvey",b);var c=a.Get("SetTriggerWirelessSiteSurveyResponse/WaitTime");var d=a.Get("SetTriggerWirelessSiteSurveyResponse/SetTriggerWirelessSiteSurveyResult");setTimeout('ShowSiteSurveyLists("'+d+'", '+c+")",c*1000)}function TriggerSiteSurvey(){checkTimeout();document.getElementById("scan_wifi_list_block").style.display="block";document.getElementById("scan_waiting").style.display="block";document.getElementById("scan_list").style.display="none";EventSiteSurvey()}function OnClickSelect(){if(selected_ssid==""||selected_ssid==null){alert(I18N("j","Please select a wireless station."))}else{CloseSiteSurveyList();document.getElementById("apclient_ssid").value=selected_ssid;var a=document.getElementById("apclient_security");var b;if(selected_security.indexOf("WPA")>=0){b="WPA+2PSK"}else{if(selected_security.indexOf("WEP")>=0){b="WEP"}else{b="NONE"}}$("#apclient_security").selectbox("detach");COMM_SetSelectValue(a,b);$("#apclient_security").selectbox();ChangeSecurity(selected_security)}}function CloseSiteSurveyList(){document.getElementById("scan_wifi_list_block").style.display="none";document.getElementById("scan_waiting").style.display="none";document.getElementById("scan_list").style.display="none"}function ChangeSecurity(a){switch(a){case"NONE":document.getElementById("apclient_wep_passlen_tr").style.display="none";document.getElementById("apclient_passwd_tr").style.display="none";break;case"WEP":document.getElementById("apclient_wep_passlen_tr").style.display="table-row";document.getElementById("apclient_passwd_tr").style.display="table-row";break;case"WPA+2PSK":document.getElementById("apclient_wep_passlen_tr").style.display="none";document.getElementById("apclient_passwd_tr").style.display="table-row";break}}function SaveAPClientValue(){var c=HNAP.GetXML("SetAPClientSettings");if(selected_wlmode=="24"){c.Set("SetAPClientSettings/RadioID","RADIO_2.4GHz")}else{if(selected_wlmode=="5"){c.Set("SetAPClientSettings/RadioID","RADIO_5GHz")}else{c.Set("SetAPClientSettings/RadioID","RADIO_MANUAL")}}if(support_apclient||support_repeater){c.Set("SetAPClientSettings/Enabled","true")}else{c.Set("SetAPClientSettings/Enabled","false")}var e=document.getElementById("apclient_ssid").value;c.Set("SetAPClientSettings/SSID",e);var d=document.getElementById("apclient_security").value;var b=document.getElementById("apclient_passwd").value;switch(d){case"NONE":c.Set("SetAPClientSettings/SupportedSecurity/SecurityInfo/SecurityType",d);c.Set("SetAPClientSettings/SupportedSecurity/SecurityInfo/Encryptions/string","NONE");break;case"WEP":c.Set("SetAPClientSettings/SupportedSecurity/SecurityInfo/SecurityType",d);c.Set("SetAPClientSettings/SupportedSecurity/SecurityInfo/Encryptions/string","WEPAUTO");c.Set("SetAPClientSettings/Key",b);break;case"WPA+2PSK":c.Set("SetAPClientSettings/SupportedSecurity/SecurityInfo/SecurityType",d);c.Set("SetAPClientSettings/SupportedSecurity/SecurityInfo/Encryptions/string","TKIP+AES");c.Set("SetAPClientSettings/Key",b);break}var a=HNAP.SetXMLAsync("SetAPClientSettings",c)}function AutoWLanMode(){selected_wlmode="manual"}function Start_reciprocal_Number_RestoreConfiguration(){if(_ReciprocalNumber>=0){document.getElementById("reciprocal_Number").innerHTML=_ReciprocalNumber+" "+I18N("j","Sec");_ReciprocalNumber--;setTimeout("Start_reciprocal_Number_RestoreConfiguration()",1000)}else{document.getElementById("waitSettingFinish").style.display="none";document.getElementById("SuccessSettings").style.display="inline"}}function returnToHome(){window.location.reload()}function Regenerate_PIN(){var a="";var d=0;var c=0;var e=0;for(var b=0;b<7;b++){e=(Math.floor(Math.random()*9));a+=e;d+=parseInt(e,[10])*(((b%2)==0)?3:1)}c=(10-(d%10))%10;a+=c;document.getElementById("dev_pin").value=a}function Save_Dev_Pin(){var a=HNAP.GetXML("SetWiFiVerifyAlpha");a.Set("SetWiFiVerifyAlpha/WPS/DEV_PIN",document.getElementById("dev_pin").value);var b=HNAP.SetXML("SetWiFiVerifyAlpha",a);location.reload()}function CheckPIN(e){if(e.length==4&&/^[0-9]*$/.test(e)){return e}else{if((e.length==9&&/[0-9]{4}(\-|\s)[0-9]{4}/.test(e))||(e.length==8&&/^[0-9]*$/.test(e))){if(e[4]=="-"){var a=e.split("-");e=a[0]+a[1]}else{if(e[4]==" "){var a=e.split(" ");e=a[0]+a[1]}}var c=0;var d=3;for(var b=0;b<8;b++){c=d*e.charAt(b)+c;if(d==3){d=1}else{d=3}}if((c%10)==0){return e}else{return false}}else{return false}}}function Conn_PIN_Client(){var c=CheckPIN(document.getElementById("pin_num").value);if(c){var a=HNAP.GetXML("SetWiFiVerifyAlpha");a.Set("SetWiFiVerifyAlpha/WPS/WPSPIN",c);var b=HNAP.SetXML("SetWiFiVerifyAlpha",a)}else{alert("Invalid PIN code!")}}function Conn_PBC(){var a=HNAP.GetXML("SetWiFiVerifyAlpha");a.Set("SetWiFiVerifyAlpha/WPS/WPSPBC","1");var b=HNAP.SetXML("SetWiFiVerifyAlpha",a)}function ResetToUnconfigured(){var a=HNAP.GetXML("SetWiFiVerifyAlpha");a.Set("SetWiFiVerifyAlpha/WPS/ResetToUnconfigured","1");var b=HNAP.SetXML("SetWiFiVerifyAlpha",a)};</script> <script language="JavaScript">$(function(){$("button").click(function(){save_button_changed()});$("input, textarea, select").change(function(){save_button_changed()});$("input, textarea").keypress(function(){save_button_changed()})});</script> <style>.btn_radius{font-family:Arial,Helvetica,sens-serif;border-radius:5px;border:solid 1px #4394a7;COLOR:#fff;background-color:#4394a7;width:80px;height:30px;text-align:center}.btn_radius2{font-family:Arial,Helvetica,sens-serif;border-radius:5px;background-color:#007086;border:solid 1px #FFF;color:#fff;width:80px;height:25px;text-align:center}.PopAlertBlackBg{position:fixed;z-index:101;top:0;left:0;width:100%;height:100%;background:url(../image/black_bg.png);text-align:center}.scanPopBox{position:relative;top:100px;width:331px;height:auto;margin:0 auto}.waitScanBox{position:relative;text-align:center;top:100px;left:80px;width:222px;height:206px;background:url(../image/wisp_loading.png) left top repeat-y}.scanListBox{border-radius:10px;position:relative;top:100px;background-color:#007086;border:solid 1px #FFF;color:#FFF;padding:10px;width:331px;height:auto;text-align:left}.list_content_div{color:#333;background-color:#FFF;width:100%;height:250px;overflow:auto}.content{border-bottom:solid 1px #ccc}div.emptyline{height:12px}</style> </head> <body> <form name="wifi_form" id="wifi_form" method="POST" action=""> <div id="wrapper"> <div id="header"></div> <div id="menu"></div> <div id="content"> <div id="info"> <div id="FunctionName"><script>I18N("h","Wireless(Wi-Fi)");</script></div> <div id="wallimage"><img src="image/wifi_24.png" alt="" width="195" height="119"/></div> <div id="directions"> <script>I18N("h","Use this section to configure the wireless settings for your D-Link Router. Please note that changes made on this section may also need to be duplicated on your Wireless Client.");</script> </div> </div> <div id="funcBar"> <div id="pagePath">&nbsp;<script>I18N("h","Settings");</script> >> <script>I18N("h","Wireless(Wi-Fi)");</script></div> <ul id="rightFunc"> <li style="display:block"><div id="Save_btn" onclick="document.getElementById('sumbit_CheckData').click()" style="cursor:pointer; display:none"><script>I18N("h","Save");</script></div></li> <li style="display:block"><div id="Save_Disable_btn"><script>I18N("h","Save");</script></div></li> <input id="sumbit_CheckData" class="submit" type="submit" value="Submit" style="display:none"/> <li id="FUNC_Guest" style="display:block"><a href="javascript:CheckHTMLStatus('GuestZone');" style="text-decoration:none;" onclick="return confirmExit()"><div id="page_btn" class="linkstyle_1"><script>I18N("h","Guest Zone");</script></div></a></li> </ul> </div> <div id="main"> <div id="WIFI_STA" style="display:none;"> <table class="block"> <tbody> <tr> <td><div class="title"><script>I18N("h","Station");</script></div></td> <td></td> </tr> <tr> <th><script>I18N("h","Wireless Network Name");</script>:</th> <td width="220px"> <input class="styled-text" type="text" id="apclient_ssid" name="apclient_ssid" size="30" maxlength="32" onChange="AutoWLanMode()"/> </td> <td> <button id="apclient_scan_btn" type="button" class="btn_radius" onClick="TriggerSiteSurvey()" style="cursor:pointer"/><script>I18N("h","Scan");</script> </td> </tr> <tr> <th><script>I18N("h","Security");</script>:</th> <td> <div class="styled-select"> <select id="apclient_security" onChange="ChangeSecurity(this.value)"> <option value="NONE">None</option> <option value="WEP">WEP</option> <option value="WPA+2PSK">WPA/WPA2-Personal</option> </select> </div> </td> <td></td> </tr> <tr id="apclient_wep_passlen_tr" style="display:none;"> <th><script>I18N("h","Password Length");</script>:</th> <td> <div class="styled-select"> <select id="apclient_wep_passlen"> <option value="64Hex">64 bit(10 hex digits)</option> <option value="64ASCII">64 bit(5 ascii characters)</option> <option value="128Hex">128 bit(26 hex digits)</option> <option value="128ASCII">128 bit(13 ascii characters)</option> </select> </div> </td> <td></td> </tr> <tr id="apclient_passwd_tr" style="display:none;"> <th><script>I18N("h","Password");</script>:</th> <td><input id="apclient_passwd" name="apclient_passwd" class="styled-text" type="text" size="27" autocomplete="off"></td> <td></td> </tr> </tbody> </table> </div> <div id="SMART_CONNECT" style="display:block"> <table class="block" border="0" cellspacing="0" style="margin: 10px 0 0 0;"> <tbody> <tr> <td><div class="title"><script>I18N("h","Smart Connect");</script></div></td> <td></td> </tr> <tr> <th><script>I18N("h","Smart Connect");</script>:</th> <td> <div id="status_smartconnect" class="checkbox_on" onclick="ChangeBandStatus('smartconnect')"> <input type="checkbox" id="status_smart_connect_ck" name="status_smart_connect_ck" checked> </div> </td> </tr> <tr id="smartconnect_ssid_tr" style="display:none;"> <th><script>I18N("h","Wi-Fi Name (SSID)");</script>:</th> <td><input class="styled-text" type="text" name="wifiName_smartconnect" maxlength="32" size="30" id="wifiName_smartconnect"></td> </tr> <tr id="smartconnect_passwd_tr" style="display:none;"> <th><script>I18N("h","Password");</script>:</th> <td><input class="styled-text" type="text" name="password_smartconnect" size="30" id="password_smartconnect"></td> </tr> </tbody> </table> <div id="smartconnect_line" style="display:none;" class="advButton" onclick="showAdv('SMART_CONNECT_adv');"><script>I18N("h","Advanced Settings");</script>...</div> <hr/> <div id="SMART_CONNECT_adv" style="display:none"> <table class="block"> <tbody> <tr> <th><script>I18N("h","Security Mode");</script>:</th> <td> <div class="styled-select"> <select name="security_smartconnect" id="security_smartconnect" onChange="ChangePasswordInput(this.value)"> <option value="None">None</option> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Transmission Power");</script>:</th> <td> <div class="styled-select"> <select name="transmissionPower_smartconnect" id="transmissionPower_smartconnect"> <option value="100" selected>High</option> <option value="50">Medium</option> <option value="25">Low</option> </select> </div> </td> </tr> <tr> <th><a href="Schedule.html"><script>I18N("h","Schedule");</script></a>:</th> <td> <div class="styled-select"> <select name="schedule_smartconnect" id="schedule_smartconnect"> <option value="ALWAYS" selected>Always</option> </select> </div> </td> </tr> </tbody> </table> <hr/> </div> </div> <div id="separated_line" style="display:none"> <hr/> </div> <div id="RADIO_2GHz" style="display:none"> <table class="block" border="0" cellspacing="0" style="margin: 10px 0 0 0;"> <tbody> <tr> <td><div class="title">2.4GHz</div></td> <td></td> </tr> <tr> <th><script>I18N("h","Status");</script>:</th> <td> <div id="status_24" class="checkbox_on" onclick="ChangeBandStatus('24')"> <input type="checkbox" id="status_24_ck" name="status_24_ck" checked> </div> </td> </tr> <tr> <th><script>I18N("h","Wi-Fi Name (SSID)");</script>:</th> <td><input class="styled-text" type="text" name="wifiName_24" maxlength="32" size="30" id="wifiName_24"></td> </tr> <tr> <th><script>I18N("h","Password");</script>:</th> <td><input class="styled-text" type="text" name="password_24" size="30" id="password_24"></td> </tr> </tbody> </table> <div class="advButton" onclick="showAdv('RADIO_2GHz_adv');"><script>I18N("h","Advanced Settings");</script>...</div> <hr/> <div id="RADIO_2GHz_adv" style="display:none"> <table class="block"> <tbody> <tr> <th><script>I18N("h","Security Mode");</script>:</th> <td> <div class="styled-select"> <select name="security_24" id="security_24" onChange="ChangeSupportModeList(this.value, '24')"> <option value="None">None</option> </select> </div> </td> </tr> <tr id="show_80211Mode_24G"> <th><script>I18N("h","802.11 Mode");</script>:</th> <td> <div class="styled-select"> <select name="80211Mode_24" id="80211Mode_24" onChange="ChangeWidthList('24')"> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Wi-Fi Channel");</script>:</th> <td> <div class="styled-select"> <select name="channel_24" id="channel_24" onChange="ChangeWidthList('24')"> <option value="0">Auto</option> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Transmission Power");</script>:</th> <td> <div class="styled-select"> <select name="transmissionPower_24" id="transmissionPower_24"> <option value="100" selected>High</option> <option value="50">Medium</option> <option value="25">Low</option> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Channel Width");</script>:</th> <td> <div class="styled-select"> <select name="channelWidth_24" id="channelWidth_24"> <option value="20">20 MHz</option> <option value="0">Auto 20/40 MHz</option> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Visibility Status");</script>:</th> <td> <div class="styled-select"> <select name="visibilityStatus_24" id="visibilityStatus_24"> <option value="true">Visible</option> <option value="false">Invisible</option> </select> </div> </td> </tr> <tr> <th><a href="Schedule.html"><script>I18N("h","Schedule");</script></a>:</th> <td> <div class="styled-select"> <select name="schedule_24" id="schedule_24"> <option value="ALWAYS" selected>Always</option> </select> </div> </td> </tr> </tbody> </table> <hr/> </div> </div> <div id="RADIO_5GHz" style="display:none"> <table class="block" style="margin: 10px 0 0 0;"> <tbody> <tr> <td><div class="title"><script>I18N("h","Primary 5GHz");</script></div></td> <td></td> </tr> <tr> <th><script>I18N("h","Status");</script>:</th> <td> <div id="status_5" class="checkbox_on" onclick="ChangeBandStatus('5')"> <input type="checkbox" id="status_5_ck" name="status_5_ck" checked> </div> </td> </tr> <tr> <th><script>I18N("h","Wi-Fi Name (SSID)");</script>:</th> <td><input class="styled-text" type="text" name="wifiName_5" size="30" maxlength="32" id="wifiName_5"></td> </tr> <tr> <th><script>I18N("h","Password");</script>:</th> <td><input class="styled-text" type="text" name="password_5" size="30" id="password_5"></td> </tr> </tbody> </table> <div class="advButton" onclick="showAdv('RADIO_5GHz_adv');"><script>I18N("h","Advanced Settings");</script>...</div> <hr/> <div id="RADIO_5GHz_adv" style="display:none"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","Security Mode");</script>:</th> <td> <div class="styled-select"> <select name="security_5" id="security_5" onChange="ChangeSupportModeList(this.value, '5')"> <option value="None">None</option> </select> </div> </td> </tr> <tr id="show_80211Mode_5G"> <th><script>I18N("h","802.11 Mode");</script>:</th> <td> <div class="styled-select"> <select name="80211Mode_5" id="80211Mode_5" onChange="ChangeWidthList('5')"> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Wi-Fi Channel");</script>:</th> <td> <div class="styled-select"> <select name="channel_5" id="channel_5" onChange="ChangeWidthList('5')"> <option value="0">Auto</option> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Transmission Power");</script>:</th> <td> <div class="styled-select"> <select name="transmissionPower_5" id="transmissionPower_5"> <option value="100" selected>High</option> <option value="50">Medium</option> <option value="25">Low</option> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Channel Width");</script>:</th> <td> <div class="styled-select"> <select name="channelWidth_5" id="channelWidth_5"> <option value="0">Auto 20/40 MHz</option> <option value="1">Auto 20/40/80 MHz</option> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Visibility Status");</script>:</th> <td> <div class="styled-select"> <select name="visibilityStatus_5" id="visibilityStatus_5"> <option value="true">Visible</option> <option value="false">Invisible</option> </select> </div> </td> </tr> <tr> <th><a href="Schedule.html"><script>I18N("h","Schedule");</script></a>:</th> <td> <div class="styled-select"> <select name="schedule_5" id="schedule_5"> <option value="ALWAYS" selected>Always</option> </select> </div> </td> </tr> </tbody> </table> <hr/> </div> </div> <div id="RADIO_5GHz_hi" style="display:none"> <table class="block" style="margin: 10px 0 0 0;"> <tbody> <tr> <td><div class="title"><script>I18N("h","Secondary 5GHz");</script></div></td> <td></td> </tr> <tr> <th><script>I18N("h","Status");</script>:</th> <td> <div id="status_5hi" class="checkbox_on" onclick="ChangeBandStatus('5hi')"> <input type="checkbox" id="status_5hi_ck" name="status_5hi_ck" checked> </div> </td> </tr> <tr> <th><script>I18N("h","Wi-Fi Name (SSID)");</script>:</th> <td><input class="styled-text" type="text" name="wifiName_5hi" size="30" maxlength="32" id="wifiName_5hi"></td> </tr> <tr> <th><script>I18N("h","Password");</script>:</th> <td><input class="styled-text" type="text" name="password_5hi" size="30" id="password_5hi"></td> </tr> </tbody> </table> <div class="advButton" onclick="showAdv('RADIO_5GHz_hi_adv');"><script>I18N("h","Advanced Settings");</script>...</div> <hr/> <div id="RADIO_5GHz_hi_adv" style="display:none"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","Security Mode");</script>:</th> <td> <div class="styled-select"> <select name="security_5hi" id="security_5hi" onChange="ChangeSupportModeList(this.value, '5hi')"> <option value="None">None</option> </select> </div> </td> </tr> <tr id="show_80211Mode_5G_hi"> <th><script>I18N("h","802.11 Mode");</script>:</th> <td> <div class="styled-select"> <select name="80211Mode_5hi" id="80211Mode_5hi" onChange="ChangeWidthList('5hi')"> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Wi-Fi Channel");</script>:</th> <td> <div class="styled-select"> <select name="channel_5hi" id="channel_5hi" onChange="ChangeWidthList('5hi')"> <option value="0">Auto</option> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Transmission Power");</script>:</th> <td> <div class="styled-select"> <select name="transmissionPower_5hi" id="transmissionPower_5hi"> <option value="100" selected>High</option> <option value="50">Medium</option> <option value="25">Low</option> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Channel Width");</script>:</th> <td> <div class="styled-select"> <select name="channelWidth_5hi" id="channelWidth_5hi"> <option value="0">Auto 20/40 MHz</option> <option value="1">Auto 20/40/80 MHz</option> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Visibility Status");</script>:</th> <td> <div class="styled-select"> <select name="visibilityStatus_5hi" id="visibilityStatus_5hi"> <option value="true">Visible</option> <option value="false">Invisible</option> </select> </div> </td> </tr> <tr> <th><a href="Schedule.html"><script>I18N("h","Schedule");</script></a>:</th> <td> <div class="styled-select"> <select name="schedule_5hi" id="schedule_5hi"> <option value="ALWAYS" selected>Always</option> </select> </div> </td> </tr> </tbody> </table> <hr/> </div> </div> <div id="wpspage" style="display:none"> <table class="block" border="0"> <tbody> <tr> <td><div class="title">WI-FI PROTECTED SETUP</div></td> </tr> <tr> <th><script>I18N("h","WPS status");</script>:</th> <td><span name="wps_status" id="wps_status"></span></td> </tr> <tr> <th><script>I18N("h","Device PIN");</script>:</th> <td> <input class="styled-text" type="text" name="dev_pin" size="15" maxlength="16" id="dev_pin" disabled="1"> <button type="button" class="button_pin" onClick="Regenerate_PIN()" style="cursor:pointer"/><script>I18N("h","Generate New PIN");</script> </td> </tr> <tr> <th></th> <td> <button type="button" class="button_pin" onClick="Save_Dev_Pin()" style="cursor:pointer"/><script>I18N("h","Save Device PIN");</script> <button type="button" class="button_pin" id="ResetWPS" onClick="ResetToUnconfigured()" style="cursor:pointer"/><script>I18N("h","Reset to Unconfigured");</script> </td> </tr> </tbody> </table> <hr/> <table class="block" style="margin: 10px 0 0 0;"> <tbody> <tr> <th>Connet to Device</th> </tr> <tr> <th><script>I18N("h","PBC");</script>:</th> <td><button type="button" class="button_pbc" id="pbc_button" onClick="Conn_PBC()" style="cursor:pointer"/><script>I18N("h","PBC Start");</script></td> </tr> <tr> <th><script>I18N("h","PIN");</script>:</th> <td> <input class="styled-text" type="text" name="pin_num" size="30" maxlength="32" id="pin_num"> <button type="button" class="button_pin" id="pin_button" onClick="Conn_PIN_Client()" style="cursor:pointer"/><script>I18N("h","PIN Start");</script> </td> </tr> </tbody> </table> </div> <div id="CreatePopAlertMessage" style="display:none"> <div id="AlertPopRect"> <div id="AlertPopBody"> <table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0" style="display:none"> <tbody> <tr> <td> <center><div id="Loading_pop_image2"></div></center> </td> </tr> <tr> <td><center><label id="reciprocal_Number">10</label></center></td> </tr> <tr> <td id="dialog_msg_black2"><script>I18N("h","Your changes are being saved.");</script></td> </tr> </tbody> </table> <table class="myAlertPop_table_b" id="SuccessSettings" border="0" cellspacing="0" style="display:none"> <tbody> <tr> <td> <center><div id="Information_pop_image"></div></center> </td> </tr> <tr> <td> <div id="dialog_msg_black"><script>I18N("h","The new settings have been saved.");</script></div> </td> </tr> <tr> <td> <center><div id="Confirm_btn" onclick="returnToHome()" style="cursor:pointer"><script>I18N("h","OK");</script></div></center> </td> </tr> </tbody> </table> </div> </div> </div> <div id="scan_wifi_list_block" class="PopAlertBlackBg" style="display:none"> <div class="scanPopBox"> <div id="scan_waiting" class="waitScanBox" style="display:none"> <br/> <br/> <br/> <center><img src="image/loading.gif" border="0"></center> <div><span><script>I18N("h","Scanning...");</script></span></div> <br/> </div> <div id="scan_list" class="scanListBox" style="display:none"> <div id="scan_list_title"> <table width="100%" cellspacing="0" cellpadding="0" border="0"> <tbody> <tr> <td><b><script>I18N("h","Available hotspot networks");</script></b></td> <td style="text-align: right;"> <a href="javascript:TriggerSiteSurvey()"><img src="image/wisp_reload.gif" border="0"></a> <a href="javascript:CloseSiteSurveyList()"><img src="image/wisp_close.gif" width="24" height="25" border="0"></a> </td> </tr> </tbody> </table> </div> <div class="emptyline"></div> <div id="scan_list_content"> <div class="list_content_div"> <table id="content_tb" width="100%" cellspacing="0" cellpadding="5" border="0" style="cursor:pointer"> </table> </div> </div> <div class="emptyline"></div> <div id="scan_list_slb"> <center> <div id="apclient_select_btn" onclick="OnClickSelect()" class="btn_radius2" style="cursor:pointer"> <script>I18N("h","Select");</script> </div> </center> </div> <div class="emptyline"></div> </div> </div> </div> </div> <div id="DetectRouterConnection" style="display:none"></div> <div id="footer"> <div id="copyright"><script>I18N("h","COPYRIGHT");</script></div> </div> </div> </div> </form> <script type="text/javascript" charset="utf-8">$(document).ready(function(){$.validator.addMethod("checkSetValues",function(k,e){var h=e.id;var i="";if(h.indexOf("wifiName")>=0||h=="apclient_ssid"){if(k==""||k==null){i=I18N("j","Please enter a Wi-Fi Name(SSID).")}}if(h.indexOf("password")>=0){var f=h.split("_");var l=f[1];var d=document.getElementById("security_"+l).value;if(d!="None"){if(d.match("WEP")=="WEP"){if(d=="WEP"){if(k.length!=13){i=I18N("j","Your password must be 13 characters length")}}else{if(k.length==10||k.length==26){if(!(/^[0-9a-fA-F]*$/.test(k))){i=I18N("j","WEP password length is 10 or 26, password type must be Hexadecimal.")}}else{if(k.length!=5&&k.length!=13){i=I18N("j","Your password must be 5 or 10 or 13 or 26 length.")}}}}else{if(d.match("WPA")=="WPA"){if(d=="WPA/WPA2-Personal"){if(k.length>63||k.length<8){i=I18N("j","Your password must be between 8-63 characters length")}}else{if(k.length==64){if(!(/^[0-9a-fA-F]*$/.test(k))){i=I18N("j","WPA password length is 64, password type must be Hexadecimal.")}}else{if(k.length>64||k.length<8){i=I18N("j","Your password must be between 8-63 characters length")}}}}}if(k==""||k==null){i=I18N("j","Please enter a password.")}}}if(h=="apclient_passwd"){var c=/^[a-f0-9]{10}$/;var b=/^[a-f0-9]{26}$/;var d=document.getElementById("apclient_security").value;var j=document.getElementById("apclient_wep_passlen").value;if(d!="NONE"){if(d=="WEP"){if((j=="64Hex"&&!c.test(k))||(j=="128Hex"&&!b.test(k))){i=I18N("j","Please enter a value between 0 and FF.")}else{if((j=="64Hex"&&k.length!=10)||(j=="64ASCII"&&k.length!=5)){i=I18N("j","Your password must be 5 or 10 characters length.")}else{if((j=="128Hex"&&k.length!=26)||(j=="128ASCII"&&k.length!=13)){i=I18N("j","Your password must be 13 or 26 characters length.")}}}}else{if(d=="WPA+2PSK"){var g=/^[0-9a-fA-F]{64}$/;if(k.length>64||k.length<8){i=I18N("j","Your password must be between 8-64 characters length.")}else{if(k.length==64&&!g.test(k)){i=I18N("j","WPA password length is 64, password type must be Hexadecimal.")}}}}if(k==""||k==null){i=I18N("j","Please enter a password.")}}}return i},"");$("#wifi_form").validate({submitHandler:function(b){CheckConnectionStatus()}});var a=$("#wifiName_24, #password_24, #wifiName_5, #password_5, #wifiName_5hi, #password_5hi, #wifiName_smartconnect, #password_smartconnect, #apclient_ssid, #apclient_passwd");$.each(a,function(c,b){$(this).rules("add",{checkSetValues:true})})});</script> </body> <script type="text/javascript">Load_HTML();Initial();setMenu("menu_Settings");GetRadioInfo();InitWLAN();checkTimeout();</script> </html>